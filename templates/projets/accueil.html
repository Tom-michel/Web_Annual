{% extends 'base.html' %}
{% load static %}

{% block title %} Accueil | Annuaire {% endblock %}


{% block content %} 

    <!-- ------------ formulaire de création d'un projet ----------- -->
    {% if err_proj != "" %}
    <div class="modal top fade show" id="createProjectModal" tabindex="-1" aria-labelledby="createProjectModalLabel" data-mdb-backdrop="true" data-mdb-keyboard="true" aria-modal="true" role="dialog" style="background: rgba(0, 0, 0, 0.7) !important; display: block; padding-left: 0px;">
    {% else %}
    <div class="modal fade" id="createProjectModal" tabindex="-1" aria-labelledby="createProjectModalLabel" aria-hidden="true">
    {% endif %}
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <form action="" method="post">
                    {% csrf_token %}
                    <div class="modal-header">
                        <h5 class="modal-title" id="createProjectModalLabel">Créer/Modifier un projet</h5>
                        <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                        {% if err_proj != "" %}
                        <span class="btn-close" data-mdb-dismiss="modal" aria-label="Close" onclick="history.back();"><i class="fa-solid fa-xmark"></i></span>
                        {% else %}
                        <span class="btn-close" data-mdb-dismiss="modal" aria-label="Close"><i class="fa-solid fa-xmark"></i></span>
                        {% endif %}
                    </div>
                    <div class="modal-body">
                        <div class="container loginForm">
                            <p></p><p></p>
                            <div class="mb-4">
                                {% for err in err_proj %}
                                <p class="errornotes">{{err}}</p>
                                {% endfor %}
                            </div>

                            <!-- titre -->
                            <div class="form-outline mb-4">
                                {{project_form.titre}}
                                <label class="form-label" for="id_intitule" style="margin-left: 0px;">Titre du projet *</label>
                            <div class="form-notch"><div class="form-notch-leading" style="width: 9px;"></div><div class="form-notch-middle" style="width: 107.2px;"></div><div class="form-notch-trailing"></div></div></div>
                            
                            <!-- description -->
                            <div class="form-outline mb-4">
                                {{project_form.description}}
                                <label class="form-label" for="id_progression" style="margin-left: 0px;">Description</label>
                            <div class="form-notch"><div class="form-notch-leading" style="width: 9px;"></div><div class="form-notch-middle" style="width: 107.2px;"></div><div class="form-notch-trailing"></div></div></div>
                            
                            <!-- {{project_form.as_p}} -->

                            <input type="submit" class="btn-bleu mb-4" value="Valider" style="width: 100%;">
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>



    <section id="accueil" class="my-5 pt-3">
        <div class="container mt-3">
            <div class="header">
                <h6>Projets</h6>
                {% comment %} {% if projets and request.user.membre.role == "admin" %} {% endcomment %}
                <a href="" class="btn-bleu" data-mdb-toggle="modal" data-mdb-target="#createProjectModal">Créer +</a>
                {% comment %} {% endif %} {% endcomment %}
                <h6>{{projets.count}} résultat{{projets.count|pluralize}}</h6>
            </div>
            <hr>
        </div>

        <div class="container cont mt-3">
        {% if projets %}

            <div class="page my-2">
                <div class="sidebar md">
                    <div class="side shadow">
                        <div class="side-head rounded-top">
                            <h5>Projets Publiques</h5>
                        </div>
                        <div class="side-content">
                            <img src="{% static 'img/team-work.jpg' %}" alt="">
                            <p>
                                Les <b>projets publiques</b> sont visibles pour tous les utilisateurs inscrits sur la plateforme. 
                                Ceux-ci peuvent consulter l'activité du dit projet.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="page-content">
                    <div class="h5 mb-2 dropdown">
                        <span>Liste des projets publiques</span>
                        <i class="fa-solid fa-circle-question" 
                        id="pub-proj" data-bs-toggle="dropdown" aria-expanded="false"></i>
                        <ul class="dropdown-menu" aria-labelledby="pub-proj">
                            <div class="sidebar drop">
                                <div class="side shadow">
                                    <div class="side-head rounded-top">
                                        <h5>Projets Publiques</h5>
                                    </div>
                                    <div class="side-content">
                                        <img src="{% static 'img/team-work.jpg' %}" alt="">
                                        <p>
                                            Les <b>projets publiques</b> sont visibles pour tous les utilisateurs inscrits sur la plateforme. 
                                            Ceux-ci peuvent consulter l'activité du dit projet.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </ul>
                    </div>
                    <div class="projet">
                        {% for projet in public_proj %}
                        <a class="p-box" href="{% url 'projet' projet.id %}" data-mdb-toggle="tooltip" title="{{projet.description}}">
                            <div class="projet-card">
                                <div class="proj-img">
                                    <div class="proj-img">
                                        <img src="{% static 'img/pp.jpeg' %}" alt="">
                                    </div>
                                </div>
                                <div class="proj-title">
                                    {{projet.titre}}
                                </div>
                                <div class="proj-foot">
                                    <span>{{projet.created}}</span>
                                    <span class="bg-primary rounded-pill px-2" style="color: #fff;">
                                        <i class="fa-solid fa-ellipsis"></i>
                                    </span>
                                </div>
                            </div>
                        </a>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <div class="page mt-5">
                <div class="sidebar md">
                    <div class="side shadow">
                        <div class="side-head rounded-top">
                            <h5>Projets Privés</h5>
                        </div>
                        <div class="side-content">
                            <img src="{% static 'img/private_proj.jpg' %}" alt="">
                            <p>
                                Les <b>projets Privés</b> sont visibles pour tous les utilisateurs inscrits sur la plateforme. 
                                Mais seuls les membres ajoutés comme collaborateurs peuvent consulter l'activité du dit projet.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="page-content">
                    <div class="h5 mb-2 dropdown">
                        <span>Liste de projets privés &emsp;&emsp;</span> 
                        <i class="fa-solid fa-circle-question" 
                        id="pub-proj" data-bs-toggle="dropdown" aria-expanded="false"></i>
                        <ul class="dropdown-menu" aria-labelledby="pub-proj">
                            <div class="sidebar drop">
                                <div class="side shadow">
                                    <div class="side-head rounded-top">
                                        <h5>Projets Privés</h5>
                                    </div>
                                    <div class="side-content">
                                        <img src="{% static 'img/private_proj.jpg' %}" alt="">
                                        <p>
                                            Les <b>projets Privés</b> sont visibles pour tous les utilisateurs inscrits sur la plateforme. 
                                            Mais seuls les membres ajoutés comme collaborateurs peuvent consulter l'activité du dit projet.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </ul>
                    </div>
                    <div class="projet">
                        {% for projet in private_proj %}
                        <a class="p-box" href="{% url 'projet' projet.id %}" data-mdb-toggle="tooltip" title="{{projet.description}}">
                            <div class="projet-card">
                                <div class="proj-img">
                                    <div class="proj-img">
                                        <img src="{% static 'img/pp.jpeg' %}" alt="">
                                    </div>
                                </div>
                                <div class="proj-title">
                                    {{projet.titre}}
                                </div>
                                <div class="proj-foot">
                                    <span>{{projet.created}}</span>
                                    <span class="bg-primary rounded-pill px-2" style="color: #fff;">
                                        <i class="fa-solid fa-ellipsis"></i>
                                    </span>
                                </div>
                            </div>
                        </a>
                        {% endfor %}
                    </div>
                </div>
            </div>

        {% else %}
            <style>
                body{
                    background: #fff !important;
                }
            </style>
            <div class="empty">
                <div class="content">
                    <img src="{% static 'img/lack1.jpeg' %}" alt="">
                    <h6>Aucun projet pour le moment</h6>
                    {% comment %} {% if request.user.membre.role == "admin" %} {% endcomment %}
                    <a class="btn-bleu"  data-mdb-toggle="modal" data-mdb-target="#createProjectModal">Ajouter un projet +</a>
                    {% comment %} {% endif %} {% endcomment %}
                </div>
            </div>

        {% endif %}
        </div>
    </section>

    <script>
        inputs = document.getElementsByTagName('input');
        for (let i = 0; i < inputs.length; i++) {
            inputs[i].classList.add("form-control");
        }
        document.getElementById('id_description').classList.add('form-control');
        document.getElementById('id_description').style.height = "150px"
    </script>
{% endblock %}
